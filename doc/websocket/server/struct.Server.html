<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Server` struct in crate `websocket`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Server">

    <title>websocket::server::Server - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        
        <p class='location'><a href='../index.html'>websocket</a>::<wbr><a href='index.html'>server</a></p><script>window.sidebarCurrent = {name: 'Server', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press 'S' to search, '?' for more options..."
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='../index.html'>websocket</a>::<wbr><a href='index.html'>server</a>::<wbr><a class='struct' href=''>Server</a><wbr></span><span class='out-of-band'><span id='render-detail'>
            <a id="collapse-all" href="#">[-]</a>&nbsp;<a id="expand-all" href="#">[+]</a>
        </span><a id='src-3339' href='../../src/websocket/server/mod.rs.html#81-84'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Server&lt;'a&gt; {
    // some fields omitted
}</pre><div class='docblock'><p>Represents a WebSocket server which can work with either normal (non-secure) connections, or secure WebSocket connections.</p>

<p>This is a convenient way to implement WebSocket servers, however it is possible to use any sendable Reader and Writer to obtain
 a WebSocketClient, so if needed, an alternative server implementation can be used.</p>

<h1 id="non-secure-servers" class='section-header'><a
                           href="#non-secure-servers">Non-secure Servers</a></h1><pre id='rust-example-rendered' class='rust '>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>websocket</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>thread</span>::<span class='ident'>Thread</span>;
<span class='kw'>use</span> <span class='ident'>websocket</span>::{<span class='ident'>Server</span>, <span class='ident'>Message</span>};

<span class='kw'>let</span> <span class='ident'>server</span> <span class='op'>=</span> <span class='ident'>Server</span>::<span class='ident'>bind</span>(<span class='string'>&quot;127.0.0.1:1234&quot;</span>).<span class='ident'>unwrap</span>();

<span class='kw'>for</span> <span class='ident'>request</span> <span class='kw'>in</span> <span class='ident'>server</span> {
    <span class='comment'>// Spawn a new thread for each connection.</span>
    <span class='ident'>Thread</span>::<span class='ident'>spawn</span>(<span class='kw'>move</span> <span class='op'>||</span> {
           <span class='kw'>let</span> <span class='ident'>request</span> <span class='op'>=</span> <span class='ident'>request</span>.<span class='ident'>unwrap</span>(); <span class='comment'>// Get the request</span>
           <span class='kw'>let</span> <span class='ident'>response</span> <span class='op'>=</span> <span class='ident'>request</span>.<span class='ident'>accept</span>(); <span class='comment'>// Form a response</span>
           <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>response</span>.<span class='ident'>send</span>().<span class='ident'>unwrap</span>(); <span class='comment'>// Send the response</span>

           <span class='kw'>let</span> <span class='ident'>message</span> <span class='op'>=</span> <span class='ident'>Message</span>::<span class='ident'>Text</span>(<span class='string'>&quot;Hello, client!&quot;</span>.<span class='ident'>to_string</span>());
           <span class='kw'>let</span> _ <span class='op'>=</span> <span class='ident'>client</span>.<span class='ident'>send_message</span>(<span class='ident'>message</span>);

           <span class='comment'>// ...</span>
    });
}
</pre>

<h1 id="secure-servers" class='section-header'><a
                           href="#secure-servers">Secure Servers</a></h1><pre id='rust-example-rendered' class='rust '>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>websocket</span>;
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>openssl</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>thread</span>::<span class='ident'>Thread</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>path</span>::<span class='ident'>Path</span>;
<span class='kw'>use</span> <span class='ident'>websocket</span>::{<span class='ident'>Server</span>, <span class='ident'>Message</span>};
<span class='kw'>use</span> <span class='ident'>openssl</span>::<span class='ident'>ssl</span>::{<span class='ident'>SslContext</span>, <span class='ident'>SslMethod</span>};
<span class='kw'>use</span> <span class='ident'>openssl</span>::<span class='ident'>x509</span>::<span class='ident'>X509FileType</span>;

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>context</span> <span class='op'>=</span> <span class='ident'>SslContext</span>::<span class='ident'>new</span>(<span class='ident'>SslMethod</span>::<span class='ident'>Tlsv1</span>).<span class='ident'>unwrap</span>();
<span class='kw'>let</span> _ <span class='op'>=</span> <span class='ident'>context</span>.<span class='ident'>set_certificate_file</span>(<span class='kw-2'>&amp;</span>(<span class='ident'>Path</span>::<span class='ident'>new</span>(<span class='string'>&quot;cert.pem&quot;</span>)), <span class='ident'>X509FileType</span>::<span class='ident'>PEM</span>);
<span class='kw'>let</span> _ <span class='op'>=</span> <span class='ident'>context</span>.<span class='ident'>set_private_key_file</span>(<span class='kw-2'>&amp;</span>(<span class='ident'>Path</span>::<span class='ident'>new</span>(<span class='string'>&quot;key.pem&quot;</span>)), <span class='ident'>X509FileType</span>::<span class='ident'>PEM</span>);
<span class='kw'>let</span> <span class='ident'>server</span> <span class='op'>=</span> <span class='ident'>Server</span>::<span class='ident'>bind_secure</span>(<span class='string'>&quot;127.0.0.1:1234&quot;</span>, <span class='kw-2'>&amp;</span><span class='ident'>context</span>).<span class='ident'>unwrap</span>();

<span class='kw'>for</span> <span class='ident'>request</span> <span class='kw'>in</span> <span class='ident'>server</span> {
    <span class='comment'>// Spawn a new thread for each connection.</span>
    <span class='ident'>Thread</span>::<span class='ident'>spawn</span>(<span class='kw'>move</span> <span class='op'>||</span> {
           <span class='kw'>let</span> <span class='ident'>request</span> <span class='op'>=</span> <span class='ident'>request</span>.<span class='ident'>unwrap</span>(); <span class='comment'>// Get the request</span>
           <span class='kw'>let</span> <span class='ident'>response</span> <span class='op'>=</span> <span class='ident'>request</span>.<span class='ident'>accept</span>(); <span class='comment'>// Form a response</span>
           <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>response</span>.<span class='ident'>send</span>().<span class='ident'>unwrap</span>(); <span class='comment'>// Send the response</span>

           <span class='kw'>let</span> <span class='ident'>message</span> <span class='op'>=</span> <span class='ident'>Message</span>::<span class='ident'>Text</span>(<span class='string'>&quot;Hello, client!&quot;</span>.<span class='ident'>to_string</span>());
           <span class='kw'>let</span> _ <span class='op'>=</span> <span class='ident'>client</span>.<span class='ident'>send_message</span>(<span class='ident'>message</span>);

           <span class='comment'>// ...</span>
    });
}
</pre>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><a class='stability Unmarked' title='No stability level'></a><code>impl&lt;'a&gt; <a class='struct' href='../../websocket/server/struct.Server.html' title='websocket::server::Server'>Server</a>&lt;'a&gt;</code></h3><div class='impl-items'><h4 id='method.bind' class='method'><a class='stability Unmarked' title='No stability level'></a><code>fn <a href='#method.bind' class='fnname'>bind</a>&lt;T: <a class='trait' href='http://doc.rust-lang.org/nightly/std/net/addr/trait.ToSocketAddrs.html' title='std::net::addr::ToSocketAddrs'>ToSocketAddrs</a>&gt;(addr: T) -&gt; <a class='type' href='http://doc.rust-lang.org/nightly/std/io/error/type.Result.html' title='std::io::error::Result'>Result</a>&lt;<a class='struct' href='../../websocket/server/struct.Server.html' title='websocket::server::Server'>Server</a>&lt;'a&gt;&gt;</code></h4>
<div class='docblock'><p>Bind this Server to this socket</p>
</div><h4 id='method.bind_secure' class='method'><a class='stability Unmarked' title='No stability level'></a><code>fn <a href='#method.bind_secure' class='fnname'>bind_secure</a>&lt;T: <a class='trait' href='http://doc.rust-lang.org/nightly/std/net/addr/trait.ToSocketAddrs.html' title='std::net::addr::ToSocketAddrs'>ToSocketAddrs</a>&gt;(addr: T, context: &amp;'a <a class='struct' href='../../openssl/ssl/struct.SslContext.html' title='openssl::ssl::SslContext'>SslContext</a>) -&gt; <a class='type' href='http://doc.rust-lang.org/nightly/std/io/error/type.Result.html' title='std::io::error::Result'>Result</a>&lt;<a class='struct' href='../../websocket/server/struct.Server.html' title='websocket::server::Server'>Server</a>&lt;'a&gt;&gt;</code></h4>
<div class='docblock'><p>Bind this Server to this socket, utilising the given SslContext</p>
</div><h4 id='method.socket_addr' class='method'><a class='stability Unmarked' title='No stability level'></a><code>fn <a href='#method.socket_addr' class='fnname'>socket_addr</a>(&amp;mut self) -&gt; <a class='type' href='http://doc.rust-lang.org/nightly/std/io/error/type.Result.html' title='std::io::error::Result'>Result</a>&lt;<a class='struct' href='http://doc.rust-lang.org/nightly/std/net/addr/struct.SocketAddr.html' title='std::net::addr::SocketAddr'>SocketAddr</a>&gt;</code></h4>
<div class='docblock'><p>Get the socket address of this server</p>
</div><h4 id='method.set_timeout' class='method'><a class='stability Unmarked' title='No stability level'></a><code>fn <a href='#method.set_timeout' class='fnname'>set_timeout</a>(&amp;mut self, ms: <a class='enum' href='http://doc.rust-lang.org/nightly/core/option/enum.Option.html' title='core::option::Option'>Option</a>&lt;<a href='http://doc.rust-lang.org/nightly/std/primitive.u64.html'>u64</a>&gt;)</code></h4>
<div class='docblock'><p>Prevents blocking on all future accepts after ms milliseconds have elapsed.</p>

<p>This function is used to set a deadline after which this acceptor will time out accepting any connections.
The argument is the relative distance, in milliseconds, to a point in the future after which all accepts will fail.</p>

<p>If the argument specified is None, then any previously registered timeout is cleared.</p>

<p>A timeout of 0 can be used to &quot;poll&quot; this acceptor to see if it has any pending connections.
All pending connections will be accepted, regardless of whether the timeout has expired or not (the accept will not block in this case).</p>
</div></div><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><a class='stability Stable' title='Stable'></a><code>impl&lt;'a&gt; <a class='trait' href='http://doc.rust-lang.org/nightly/core/iter/trait.Iterator.html' title='core::iter::Iterator'>Iterator</a> for <a class='struct' href='../../websocket/server/struct.Server.html' title='websocket::server::Server'>Server</a>&lt;'a&gt;</code></h3><div class='impl-items'><h4 id='assoc_type.Item' class='type'><a class='stability Unmarked' title='No stability level'></a><code>type Item = <a class='type' href='http://doc.rust-lang.org/nightly/std/io/error/type.Result.html' title='std::io::error::Result'>Result</a>&lt;<a class='struct' href='../../websocket/server/request/struct.Request.html' title='websocket::server::request::Request'>Request</a>&lt;<a class='enum' href='../../websocket/stream/enum.WebSocketStream.html' title='websocket::stream::WebSocketStream'>WebSocketStream</a>, <a class='enum' href='../../websocket/stream/enum.WebSocketStream.html' title='websocket::stream::WebSocketStream'>WebSocketStream</a>&gt;&gt;</code></h4>
<h4 id='method.next' class='method'><a class='stability Stable' title='Stable'></a><code>fn <a href='#method.next' class='fnname'>next</a>(&amp;mut self) -&gt; <a class='enum' href='http://doc.rust-lang.org/nightly/core/option/enum.Option.html' title='core::option::Option'>Option</a>&lt;&lt;<a class='struct' href='../../websocket/server/struct.Server.html' title='websocket::server::Server'>Server</a>&lt;'a&gt; as Iterator&gt;::Item&gt;</code></h4>
<h4 id='method.size_hint' class='tymethod'><a class='stability Stable' title='Stable'></a><code>fn <a href='#tymethod.size_hint' class='fnname'>size_hint</a>(&amp;self) -&gt; <a href='http://doc.rust-lang.org/nightly/std/primitive.tuple.html'>(<a href='http://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>, <a class='enum' href='http://doc.rust-lang.org/nightly/core/option/enum.Option.html' title='core::option::Option'>Option</a>&lt;<a href='http://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>&gt;)</a></code></h4>
</div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div class="shortcuts">
            <h1>Keyboard shortcuts</h1>
            <dl>
                <dt>?</dt>
                <dd>Show this help dialog</dd>
                <dt>S</dt>
                <dd>Focus the search field</dd>
                <dt>&larrb;</dt>
                <dd>Move up in search results</dd>
                <dt>&rarrb;</dt>
                <dd>Move down in search results</dd>
                <dt>&#9166;</dt>
                <dd>Go to active search result</dd>
            </dl>
        </div>
        <div class="infos">
            <h1>Search tricks</h1>
            <p>
                Prefix searches with a type followed by a colon (e.g.
                <code>fn:</code>) to restrict the search to a given type.
            </p>
            <p>
                Accepted types are: <code>fn</code>, <code>mod</code>,
                <code>struct</code>, <code>enum</code>,
                <code>trait</code>, <code>typedef</code> (or
                <code>tdef</code>).
            </p>
        </div>
    </div>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "websocket";
        window.playgroundUrl = "";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    
    <script async src="../../search-index.js"></script>
</body>
</html>